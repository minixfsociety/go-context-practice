–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É —Å —Ä—É—á–Ω–æ–π –æ—Ç–º–µ–Ω–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (context.WithCancel) –∏ –∫–æ–Ω—Ü–µ–ø—Ü–∏—é Graceful Shutdown (–ø–ª–∞–≤–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≥–æ—Ä—É—Ç–∏–Ω).

üìù –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏
–£ –Ω–∞—Å –µ—Å—Ç—å —Ñ–æ–Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å (—Å—á–µ—Ç—á–∏–∫), –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –≥–æ—Ä—É—Ç–∏–Ω–µ. –û–Ω –Ω–µ –∑–Ω–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –µ–º—É –Ω—É–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å, –ø–æ—ç—Ç–æ–º—É –æ–Ω –ø—Ä–æ—Å—Ç–æ —Å—á–∏—Ç–∞–µ—Ç —á–∏—Å–ª–∞.
–¶–µ–ª—å: –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —ç—Ç–æ—Ç —Å—á–µ—Ç—á–∏–∫ –∏–∑ –≥–ª–∞–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ main —Ä–æ–≤–Ω–æ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã, –Ω–µ "—É–±–∏–≤–∞—è" –ø—Ä–æ–≥—Ä–∞–º–º—É –≥—Ä—É–±–æ, –∞ –¥–∞–≤ –≥–æ—Ä—É—Ç–∏–Ω–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–∞–º–æ–π –∑–∞–∫–æ–Ω—á–∏—Ç—å —Ä–∞–±–æ—Ç—É.
üõ† –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏
context.WithCancel ‚Äî —Å–æ–∑–¥–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ —Ñ—É–Ω–∫—Ü–∏—é cancel. –ö–∞–∫ —Ç–æ–ª—å–∫–æ –º—ã –≤—ã–∑—ã–≤–∞–µ–º cancel(), –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∫–∞–Ω–∞–ª ctx.Done().
select –≤–Ω—É—Ç—Ä–∏ for ‚Äî –≥–æ—Ä—É—Ç–∏–Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–≤–∞ –ø—É—Ç–∏:
–ü—Ä–∏—à–µ–ª –ª–∏ —Å–∏–≥–Ω–∞–ª "–°—Ç–æ–ø" (<-ctx.Done()).
–ï—Å–ª–∏ –Ω–µ—Ç (default) ‚Äî –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å—á–∏—Ç–∞—Ç—å.
return –≤ –≥–æ—Ä—É—Ç–∏–Ω–µ ‚Äî –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç. –ë–µ–∑ –Ω–µ–≥–æ –≥–æ—Ä—É—Ç–∏–Ω–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç –≤–∏—Å–µ—Ç—å –≤ –ø–∞–º—è—Ç–∏ (—É—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏), –¥–∞–∂–µ –µ—Å–ª–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ—Ç–º–µ–Ω–µ–Ω.
–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è ‚Äî –≤ main –¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–µ–±–æ–ª—å—à–∞—è –ø–∞—É–∑–∞ –ø–æ—Å–ª–µ cancel(), —á—Ç–æ–±—ã –≥–æ—Ä—É—Ç–∏–Ω–∞ —É—Å–ø–µ–ª–∞ –Ω–∞–ø–µ—á–∞—Ç–∞—Ç—å –ø—Ä–æ—â–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–∫—Ä–æ–µ—Ç—Å—è.